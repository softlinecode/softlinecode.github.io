<br /><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">StringBuffer.java 클래스에 대해서 한번 알아보겠습니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">자바를 처음 하는 분들은 String 을 많이 사용하게 됩니다. String을 많이 사용하시다가 책이나</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">블로그 또는 사수분을 통해서 우리는 String 과 StringBuffer 에 대해서 알게 됩니다. 겉보기에는 코드양이나 객체를 new 해야한다는 등의 귀차니즘으로 String을 선호하지만 String의 값을 변경하거나 추가하는 + 기호를 많이 사용한다면 성능의 차이를 고려해봐야 할 것입니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">성능에 대한 차이에 대해서는 여기서 언급하지 않겠지만 처음 듣는 것이라면 검색을 통해서 확인해보는게 좋을 겁니다. 여기서 얘기하려는 것은 String.java 는 변경되지 않는 immutable 이고 StringBuffer.java 는 수정이 가능한 mutable 이라는 것입니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">StringBuffer.java 는 AbstractStringBuilder.java 를 상속받고 있네요. StrngBuuilder.java 도 곧 정리하도록 하겠습니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">//생성자</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">default 생성자를 보면 16이라는 여유 사이즈를 추가해서 char[]를 생성합니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">실제로 char[] 값은 StringBuffer.java 에 있지 않고 부모 클래스인 AbstractStringBuilder.java</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">에 존재합니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">public StringBuffer() {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; super(16);</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">public StringBuffer(int capacity) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; super(capacity);<br style="margin: 0px; padding: 0px;" />}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">public StringBuffer(String str) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; super(str.length() + 16);<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; append(str);<br style="margin: 0px; padding: 0px;" />}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">public StringBuffer(CharSequence seq) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp; this(seq.length() + 16);<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp;&nbsp; append(seq);<br style="margin: 0px; padding: 0px;" />}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">count는 실제 값에 대한 길이이고, value.length는 capacity를 포함한 길이입니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">그래서 실제로 StringBuffer 안에 "12345" 라는 값이 있을 경우 length() 는 5 를 return 하고, capacity() 는 5 + 16 의 결과인 21이 return 됩니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">public synchronized int length() {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; return count;<br style="margin: 0px; padding: 0px;" />}<br style="margin: 0px; padding: 0px;" /><br style="margin: 0px; padding: 0px;" />public synchronized int capacity() {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; return value.length;<br style="margin: 0px; padding: 0px;" />}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">기본적으로 StringBuffer 는 capacity 만큼 length를 더 많이 잡고 append 되면서 capacity 사이즈</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">를 초과시 다시 char[]를 세팅합니다. 물론 이 과정에서도 새로운 StringBuffer가 생기는게 아니고</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">값을 변경하는 것 입니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">public AbstractStringBuilder append(String str) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (str == null)<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; str = "null";<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int len = str.length();<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (len == 0)<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return this;<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int newCount = count + len;<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (newCount &gt; value.length)<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; expandCapacity(newCount);<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; str.getChars(0, len, value, count);<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; count = newCount;<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return this;</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">void expandCapacity(int minimumCapacity) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int newCapacity = (value.length + 1) * 2;<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (newCapacity &lt; 0) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; newCapacity = Integer.MAX_VALUE;<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } else if (minimumCapacity &gt; newCapacity) {<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; newCapacity = minimumCapacity;<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br style="margin: 0px; padding: 0px;" />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; value = Arrays.copyOf(value, newCapacity);</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">}</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">append 시 기존의 capacity 를 초과하는 값이 추가 될 경우 expandCapacity() 를</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">이용하여 value의 사이즈를 늘려서 새로 값을 할당합니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">append 시 보면 기존 char[] 의 (length + 1) *2 를&nbsp; 하는것으로 보아서 최소한 2배이상의 사이즈를</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">늘려서 체크합니다. append 시 파라미터가 String 이 아닌경우는 각자 처리하는 방식이 다르지만</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">여기서는 따로 설명하지는 않겠습니다. 핵심은 capacity를 계산한다라는 것이 중요하기 때문입니다.</div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;"><br style="margin: 0px; padding: 0px;" /></div><div style="font-family: 돋움, Dotum, AppleGothic, sans-serif; font-size: 12px; line-height: 18px; padding: 0px;">&nbsp;</div><br class="Apple-interchange-newline" />